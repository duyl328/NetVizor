### 获取所有规则
GET http://localhost:8268/api/firewall/rules

###

### 搜索 Chrome 相关规则
GET http://localhost:8268/api/firewall/rules?search=Chrome&limit=10

###

### 搜索出站规则中包含 Chrome 的
GET http://localhost:8268/api/firewall/rules?search=Chrome&direction=Outbound&limit=10

###

### 按端口搜索
GET http://localhost:8268/api/firewall/rules?search=80&limit=10

###

### 获取已启用的 TCP 规则
GET http://localhost:8268/api/firewall/rules?enabled=true&protocol=TCP&limit=10


### 测试
GET http://localhost:8268/api/firewall/rules

### 参数说明

# Direction (方向):
# 1 = Inbound (入站)
# 2 = Outbound (出站)

# Protocol (协议):
# 1 = ICMPV4
# 6 = TCP  
# 17 = UDP
# 256 = Any

# Action (动作):
# 0 = Block (阻止)
# 1 = Allow (允许)

# Profiles (配置文件):
# 1 = Domain (域)
# 2 = Private (私有)
# 4 = Public (公共)
# 7 = All (所有，即1+2+4)

### ✅ 新增防火墙规则
POST http://localhost:你的端口/api/firewall/rules
Content-Type: application/json

{
  "name": "MyRule",
  "description": "Allow my application",
  "applicationName": "C:\\Program Files\\MyApp\\app.exe",
  "localAddresses": "*",
  "remoteAddresses": "*",
  "protocol": "TCP",                // 可选值: "TCP", "UDP", "ICMPv4", "ICMPv6"
  "icmpTypesAndCodes": "",         // 仅当 protocol 为 ICMP 时使用
  "localPorts": "8080",            // 可为 "80", "80,443", "*" 等
  "remotePorts": "*",
  "direction": "Inbound",          // 可选值: "Inbound", "Outbound"
  "enabled": true,
  "profiles": "Domain,Private,Public",  // 可组合，逗号分隔
  "action": "Allow",               // 可选值: "Allow", "Block"
  "grouping": "MyAppGroup",
  "interfaceTypes": "All",         // 可选: "All", "Wireless", "LAN", etc.
  "edgeTraversal": false
}

### 响应示例：
# {
#   "success": true,
#   "message": "防火墙规则创建成功",
#   "data": null
# }

---

### ✏️ 编辑防火墙规则
PUT http://localhost:你的端口/api/firewall/rules
Content-Type: application/json

{
  "currentName": "MyRule",
  "newName": "MyRuleUpdated",
  "description": "Updated rule",
  "enabled": true,
  "applicationName": "C:\\Program Files\\MyApp\\new_app.exe",
  "protocol": "UDP",
  "localPorts": "9999",
  "remotePorts": "*",
  "localAddresses": "*",
  "remoteAddresses": "*",
  "profiles": "Private,Public",
  "action": "Block",
  "grouping": "NewGroup",
  "edgeTraversal": false
}

### 响应示例：
# {
#   "success": true,
#   "message": "防火墙规则更新成功",
#   "data": null
# }

---

### ❌ 删除防火墙规则
DELETE http://localhost:你的端口/api/firewall/rules?name=MyRuleUpdated

### 响应示例：
# {
#   "success": true,
#   "message": "防火墙规则删除成功",
#   "data": null
# }


### 启用所有配置文件的防火墙
POST http://localhost:5000/api/firewall/switch?enabled=true&profile=all
Content-Type: application/json

### 禁用公用网络的防火墙
POST http://localhost:5000/api/firewall/switch?enabled=false&profile=public
Content-Type: application/json

### 启用专用网络的防火墙（忽略大小写）
POST http://localhost:5000/api/firewall/switch?enabled=1&profile=Private
Content-Type: application/json

### 禁用域网络的防火墙（测试大小写兼容）
POST http://localhost:5000/api/firewall/switch?enabled=0&profile=DOMAIN
Content-Type: application/json

### 缺少 enabled 参数（应返回 400）
POST http://localhost:5000/api/firewall/switch?profile=all
Content-Type: application/json

### 错误的 enabled 参数（应返回 400）
POST http://localhost:5000/api/firewall/switch?enabled=maybe&profile=all
Content-Type: application/json
